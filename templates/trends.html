<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>📅 Student Performance Trend</title>

<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link rel="stylesheet" href="/static/css/navbar.css">
<link rel="stylesheet" href="/static/js/navbar.js">
<link rel="stylesheet" href="/static/css/footer.css">
<style>
body { background: #f8f9fa; font-family: Arial, sans-serif; }
.card { border-radius: 10px; margin-top: 20px; }
.table th { background-color: #0d6efd; color: white; }
#trendChart { height: 300px !important; }
</style>
</head>
<body>

<!-- Navbar (like Reports page) -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow-sm">
    <div class="container-fluid">
      <a class="navbar-brand fw-bold" href="index.html">Student Analyzer</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="dashboard-1.html">🏠 Dashboard</a></li>
          <li class="nav-item"><a class="nav-link" href="student-profile.html">👩‍🎓 Student Profile</a></li>
          <li class="nav-item"><a class="nav-link" href="subject-analysis.html">📘 Subject Analysis</a></li>
          <li class="nav-item"><a class="nav-link" href="comparison.html">📈 Comparison</a></li>
          <li class="nav-item"><a class="nav-link" href="prediction.html">🧮 Prediction</a></li>
          <li class="nav-item"><a class="nav-link" href="reports.html">📊 Reports</a></li>
          <li class="nav-item"><a class="nav-link" href="/templates/teacher-insights.html">🧑‍🏫 Teacher Insights</a></li>
          <li class="nav-item"><a class="nav-link" href="#">🗓️ Trend</a></li>
        </ul>
      </div>
    </div>
</nav>

<div class="container mt-4">

  <!-- Trend Input Form -->
  <div class="card p-3 shadow-sm">
    <h4 class="text-primary fw-bold">➕ Add Student Trend Info</h4>
    <form id="trendForm">
      <div class="row g-3 mb-3">
        <div class="col-md-3"><input type="text" id="studentName" class="form-control" placeholder="Student Name" required></div>
        <div class="col-md-2"><input type="text" id="studentID" class="form-control" placeholder="Student ID" required></div>
        <div class="col-md-2"><input type="text" id="studentClass" class="form-control" placeholder="Class/Grade" required></div>
        <div class="col-md-2"><input type="text" id="term" class="form-control" placeholder="Term/Semester" required></div>
      </div>

      <h6 class="fw-bold text-secondary">📌 Term 1 Scores</h6>
      <div class="row g-3 mb-3">
        <div class="col-md-2"><input type="number" class="form-control" id="t1BCU" placeholder="BCU" required></div>
        <div class="col-md-2"><input type="number" class="form-control" id="t1EngIT" placeholder="English for IT" required></div>
        <div class="col-md-2"><input type="number" class="form-control" id="t1GenEng" placeholder="General English" required></div>
        <div class="col-md-2"><input type="number" class="form-control" id="t1Logic" placeholder="Logic" required></div>
        <div class="col-md-2"><input type="number" class="form-control" id="t1PL" placeholder="PL" required></div>
        <div class="col-md-2"><input type="number" class="form-control" id="t1Design" placeholder="Design" required></div>
      </div>

      <h6 class="fw-bold text-secondary">📌 Term 2 Scores</h6>
      <div class="row g-3 mb-3">
        <div class="col-md-2"><input type="number" class="form-control" id="t2EngIT" placeholder="English for IT" required></div>
        <div class="col-md-2"><input type="number" class="form-control" id="t2GenEng" placeholder="General English" required></div>
        <div class="col-md-2"><input type="number" class="form-control" id="t2Algo" placeholder="Algorithm" required></div>
        <div class="col-md-2"><input type="number" class="form-control" id="t2PL" placeholder="PL" required></div>
        <div class="col-md-2"><input type="number" class="form-control" id="t2Web" placeholder="Web Design" required></div>
      </div>

      <div class="mb-3">
        <textarea id="teacherComment" class="form-control" placeholder="Teacher Comments" rows="2"></textarea>
      </div>
      <button type="submit" class="btn btn-primary">Add Trend Info</button>
    </form>
  </div>

  <!-- Trend Table -->
  <div class="card p-3 shadow-sm mt-3">
    <h5 class="text-secondary mb-3">📋 Student Trend Records</h5>
    <table class="table table-striped table-hover">
      <thead class="table-primary">
        <tr>
          <th>Student Name</th>
          <th>ID</th>
          <th>Class</th>
          <th>Term</th>
          <th>Subject</th>
          <th>Term 1 Score</th>
          <th>Term 2 Score</th>
          <th>Average</th>
          <th>Teacher Comment</th>
        </tr>
      </thead>
      <tbody id="trendTableBody"></tbody>
    </table>
  </div>

  <!-- Trend Chart -->
  <div class="card p-3 shadow-sm mt-3">
    <h5 class="text-primary mb-3">📊 Score Trend Chart</h5>
    <canvas id="trendChart"></canvas>
  </div>

</div>
    <footer>
        <p>© 2025 Student Analyzer. All Rights Reserved.</p>
        <p>
            <a href="index.html">Home</a> | 
            <a href="reports.html">Reports</a> | 
            <a href="contact.html">Contact</a>
        </p>
        <p class="social-icons">
            <a href="#" title="Facebook">📘</a>
            <a href="#" title="Twitter">🐦</a>
            <a href="#" title="LinkedIn">💼</a>
        </p>
        <p>Made with ❤️ by the Student Analyzer Team</p>
    </footer>
<script>
document.addEventListener("DOMContentLoaded", function() {
    let trends = JSON.parse(localStorage.getItem("studentTrends")) || [];

    function saveTrends() {
        localStorage.setItem("studentTrends", JSON.stringify(trends));
    }

    function renderTable() {
        const tbody = document.getElementById("trendTableBody");
        tbody.innerHTML = "";
        trends.forEach(t => {
            tbody.innerHTML += `<tr>
                <td>${t.studentName}</td>
                <td>${t.studentID}</td>
                <td>${t.studentClass}</td>
                <td>${t.term}</td>
                <td>${t.subject}</td>
                <td>${t.term1}</td>
                <td>${t.term2}</td>
                <td>${t.average}</td>
                <td>${t.teacherComment}</td>
            </tr>`;
        });
        renderChart();
    }

    function renderChart() {
        const ctx = document.getElementById("trendChart").getContext("2d");
        const subjects = trends.map(t => t.subject);
        const averages = trends.map(t => t.average);

        if(window.trendChartInstance) window.trendChartInstance.destroy();
        window.trendChartInstance = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: subjects,
                datasets: [
                    { label: 'Average Score', data: averages, backgroundColor: '#0d6efd' }
                ]
            },
            options: { responsive: true, scales: { y: { beginAtZero: true, max: 100 } } }
        });
    }

    document.getElementById("trendForm").addEventListener("submit", function(e) {
        e.preventDefault();

        const subjects = [
            {name:"BCU", t1:"t1BCU"},
            {name:"English for IT", t1:"t1EngIT", t2:"t2EngIT"},
            {name:"General English", t1:"t1GenEng", t2:"t2GenEng"},
            {name:"Logic", t1:"t1Logic"},
            {name:"PL", t1:"t1PL", t2:"t2PL"},
            {name:"Design", t1:"t1Design"},
            {name:"Algorithm", t2:"t2Algo"},
            {name:"Web Design", t2:"t2Web"}
        ];

        const studentName = document.getElementById("studentName").value;
        const studentID = document.getElementById("studentID").value;
        const studentClass = document.getElementById("studentClass").value;
        const term = document.getElementById("term").value;
        const teacherComment = document.getElementById("teacherComment").value;

        subjects.forEach(sub => {
            const t1 = sub.t1 ? parseFloat(document.getElementById(sub.t1).value || 0) : 0;
            const t2 = sub.t2 ? parseFloat(document.getElementById(sub.t2).value || 0) : 0;
            const average = ((t1 + t2)/ ( (sub.t1&&sub.t2)? 2 : 1 )).toFixed(2);
            trends.push({
                studentName, studentID, studentClass, term,
                subject: sub.name, term1: t1, term2: t2, average, teacherComment
            });
        });

        localStorage.setItem("studentTrends", JSON.stringify(trends));
        renderTable();
        this.reset();
    });

    renderTable();
});
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
